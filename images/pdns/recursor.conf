setuid=pdns
setgid=pdns

local-address=0.0.0.0
local-port=53

daemon=no
disable-syslog=yes
structured-logging-backend="json"
log-timestamp=no

# Forward all zones to local authoritative server (no external queries)
forward-zones=.=127.0.0.1:5300, test=127.0.0.1:5300, a.test=127.0.0.1:5300, b.test=127.0.0.1:5300, x.test=127.0.0.1:5300, y.test=127.0.0.1:5300, 255.10.in-addr.arpa=127.0.0.1:5300

# Disable DNSSEC validation
dnssec=off

# Disable root hints (no external DNS queries)
hint-file=no

# Disable security polling
security-poll-suffix=

# Disable root NS priming
root-nx-trust=no

# Disable packet cache to ensure Lua hooks are called for every query
disable-packetcache=yes

# Query logging via Lua script
lua-dns-script=/etc/powerdns/query-log.lua
quiet=yes
trace=no
log-common-errors=no
loglevel=3

socket-dir=/run/pdns-recursor
